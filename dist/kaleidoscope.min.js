"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var i,e=1,s=arguments.length;e<s;e++)for(var n in i=arguments[e])Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n]);return t}).apply(this,arguments)};exports.__esModule=!0;var Kaleidoscope=function(){function n(t){return Math.floor(Math.random()*Math.floor(t))}var t=(i.prototype.getPointO=function(){return this.pointO},i.prototype.getRandomCoordinates=function(){var t,i=n(Math.max(this.pointO.x,this.pointB.x)-this.pointA.x)+this.pointA.x;return{x:i,y:n((this.isSharp?(t=Math.max(this.inclinationOB*i+this.interceptOB,this.inclinationAB*i+this.interceptAB),this.inclinationOA*i+this.interceptOA):(t=this.inclinationAB*i+this.interceptAB,Math.min(this.inclinationOA*i+this.interceptOA,this.inclinationOB*i+this.interceptOB)))-t)+t}},i.prototype.isIn=function(t){var i=!0,e=t.x,s=t.y,n=2*t.size;if(this.isSharp){var h=Math.max(this.inclinationOB*e+this.interceptOB,this.inclinationAB*e+this.interceptAB);(this.inclinationOA*e+this.interceptOA<s-n||s+n<h)&&(i=!1)}else h=this.inclinationAB*e+this.interceptAB,(Math.min(this.inclinationOA*e+this.interceptOA,this.inclinationOB*e+this.interceptOB)<s-n||s+n<h)&&(i=!1);return i},i.prototype.mirror=function(t,i){var e=this.context;e.save(),e.translate(this.pointO.x,this.pointO.y),e.rotate(this.radianAOB*t),e.translate(-this.pointO.x,-this.pointO.y),e.beginPath(),e.moveTo(this.pointO.x,this.pointO.y),e.lineTo(this.pointA.x,this.pointA.y),e.lineTo(this.pointB.x,this.pointB.y),e.closePath(),e.clip(),i(),e.restore()},i.prototype.resize=function(){this.calculateBorder()},i.prototype.initializeEvents=function(){var e=this;window.addEventListener("mousemove",function(t){var i=Math.sqrt(Math.pow(t.clientX-e.pointO.x,2)+Math.pow(t.clientY-e.pointO.y,2));0!==i&&(e.directionX=(t.clientX-e.pointO.x)/i,e.directionY=(t.clientY-e.pointO.y)/i,document.querySelector(e.options.selector).dispatchEvent(new Event("change:direction")))})},i.prototype.calculateBorder=function(){var t=document.querySelector(this.options.selector);this.pointO.x=t.offsetParent?t.offsetParent.clientWidth/2:t.clientWidth/2,t.offsetParent&&"BODY"===t.offsetParent.nodeName?this.pointO.y=window.innerHeight/2:this.pointO.y=t.offsetParent?t.offsetParent.clientHeight/2:t.clientHeight/2;var i,e,s,n,h,o=Math.sqrt(Math.pow(this.pointO.x,2)+Math.pow(this.pointO.y,2)),a=o/Math.cos(this.radianAOB/2);this.pointA={x:(1-a/o)*this.pointO.x,y:(1-a/o)*this.pointO.y},this.pointB=(i=this.pointA.x,e=this.pointA.y,s=this.pointO.x,n=this.pointO.y,h=this.radianAOB,{x:Math.cos(h)*(i-s)-Math.sin(h)*(e-n)+s,y:Math.sin(h)*(i-s)+Math.cos(h)*(e-n)+n});var r=this.pointO,l=this.pointA,c=this.pointB;this.isSharp=c.x<this.pointO.x,this.inclinationOA=(l.y-r.y)/(l.x-r.x),this.interceptOA=r.y-this.inclinationOA*r.x,this.inclinationOB=(c.y-r.y)/(c.x-r.x),this.interceptOB=r.y-this.inclinationOB*r.x,this.inclinationAB=(c.y-l.y)/(c.x-l.x),this.interceptAB=l.y-this.inclinationAB*l.x},i);function i(t,i){this.directionX=0,this.directionY=0,this.options=null,this.context=null,this.radianAOB=0,this.pointO={x:0,y:0},this.pointA={x:0,y:0},this.pointB={x:0,y:0},this.isSharp=null,this.inclinationOA=0,this.interceptOA=0,this.inclinationOB=0,this.interceptOB=0,this.inclinationAB=0,this.interceptAB=0,this.context=t,this.options=i,this.radianAOB=2*Math.PI/i.edge,this.calculateBorder(),this.initializeEvents()}var h=(e.prototype.draw=function(){var t=this.context;switch(this.shape){case"square":t.save(),t.fillStyle=this.color,t.globalAlpha=this.opacity,t.translate(this.x+this.size/2,this.y+this.size/2),t.rotate(this.radian),t.translate(-(this.x+this.size/2),-(this.y+this.size/2)),t.beginPath(),t.rect(this.x,this.y,this.size,this.size),t.closePath(),t.fill(),t.restore();break;case"wave":t.save(),t.strokeStyle=this.color,t.globalAlpha=this.opacity,t.lineWidth=.3*this.size,t.lineJoin="round",t.lineCap="round",t.translate(this.x+.5*this.size,this.y+.2*this.size),t.rotate(this.radian),t.translate(-(this.x+.5*this.size),-(this.y+.2*this.size)),t.beginPath(),t.moveTo(this.x,this.y),t.lineTo(this.x+.2*this.size,this.y+.4*this.size),t.lineTo(this.x+.4*this.size,this.y),t.lineTo(this.x+.6*this.size,this.y+.4*this.size),t.lineTo(this.x+.8*this.size,this.y),t.lineTo(this.x+this.size,this.y+.4*this.size),t.stroke(),t.restore();break;case"circle":t.save(),t.fillStyle=this.color,t.globalAlpha=this.opacity,t.beginPath(),t.arc(this.x,this.y,this.size/2,0,2*Math.PI,!1),t.closePath(),t.fill(),t.restore();break;case"heart":t.save(),t.fillStyle=this.color,t.globalAlpha=this.opacity,t.translate(this.x+this.size/2,this.y+this.size/2),t.rotate(this.radian),t.translate(-(this.x+this.size/2),-(this.y+this.size/2)),t.beginPath(),t.moveTo(this.x+75*this.size/130,this.y+40*this.size/140),t.bezierCurveTo(this.x+75*this.size/130,this.y+37*this.size/140,this.x+70*this.size/130,this.y+25*this.size/140,this.x+50*this.size/130,this.y+25*this.size/140),t.bezierCurveTo(this.x+20*this.size/130,this.y+25*this.size/140,this.x+20*this.size/130,this.y+62.5*this.size/140,this.x+20*this.size/130,this.y+62.5*this.size/140),t.bezierCurveTo(this.x+20*this.size/130,this.y+80*this.size/140,this.x+40*this.size/130,this.y+102*this.size/140,this.x+75*this.size/130,this.y+120*this.size/140),t.bezierCurveTo(this.x+110*this.size/130,this.y+102*this.size/140,this.x+130*this.size/130,this.y+80*this.size/140,this.x+130*this.size/130,this.y+62.5*this.size/140),t.bezierCurveTo(this.x+130*this.size/130,this.y+62.5*this.size/140,this.x+130*this.size/130,this.y+25*this.size/140,this.x+100*this.size/130,this.y+25*this.size/140),t.bezierCurveTo(this.x+85*this.size/130,this.y+25*this.size/140,this.x+75*this.size/130,this.y+37*this.size/140,this.x+75*this.size/130,this.y+40*this.size/140),t.fill(),t.restore()}},e.prototype.updateCoordinates=function(){this.opacity<1&&(this.opacity+=.1),this.directionX&&this.directionY?(this.x+=this.v*this.directionX,this.y+=this.v*this.directionY):this.y+=this.v,this.radian+=.002*this.v*Math.PI},e.prototype.isInPipe=function(){return this.pipe.isIn(this)},e.prototype.initializeEvents=function(){var t=this;document.querySelector(this.options.selector).addEventListener("change:direction",function(){t.directionX=t.pipe.directionX,t.directionY=t.pipe.directionY})},e);function e(t,i,e){this.size=0,this.x=0,this.y=0,this.options=null,this.context=null,this.pipe=null,this.shape=null,this.color=null,this.opacity=0,this.v=0,this.radian=2*Math.PI/(n(6)+1),this.directionX=0,this.directionY=0,this.context=t,this.options=i,this.pipe=e,this.shape=i.shapes[n(i.shapes.length)],this.size=n(i.maxSize-i.minSize)+i.minSize,this.color=i.color[n(i.color.length)];var s=e.getRandomCoordinates();return this.x=s.x,this.y=s.y,this.v=(Math.random()+.5)*i.speed,this.directionX=e.directionX,this.directionY=e.directionY,this.initializeEvents(),this}var s=(o.prototype.destroy=function(){this.storage=[],this.element.remove(),window.removeEventListener("resize",this.listenerResize),cancelAnimationFrame(this.animationID)},o.prototype.pauseAnimation=function(){this.animationID&&(cancelAnimationFrame(this.animationID),this.animationID=null)},o.prototype.resumeAnimation=function(){this.animationID||this.animate()},o.prototype.initializeCanvas=function(){if(!this.options.selector)return console.warn("kaleidoscope.js: No selector specified!Check https://github.com/kawakamiakari/kaleidoscope"),!1;this.element=document.querySelector(this.options.selector),this.context=this.element.getContext("2d"),this.element.style.width="100%",this.element.style.height="100%",this.resize()},o.prototype.initializeEvents=function(){var t=this;this.listenerResize=function(){t.resize(),t.pipe.resize()},window.addEventListener("resize",this.listenerResize)},o.prototype.initializePipe=function(){this.pipe=new t(this.context,this.options)},o.prototype.initializeStorage=function(){this.storage=[];for(var t=0;t<this.options.quantity;t+=1)this.storage.push(new h(this.context,this.options,this.pipe))},o.prototype.animate=function(){var t=this;this.draw(),this.animationID=requestAnimationFrame(function(){return t.animate()})},o.prototype.draw=function(){var t=this,i=this.element,e=this.context;e.globalCompositeOperation=this.options.globalCompositeOperation,e.clearRect(0,0,i.width,i.height),this.storage.forEach(function(t){return t.updateCoordinates()}),this.storage=this.storage.filter(function(t){return t.isInPipe()});for(var s=this.storage.length;s<this.options.quantity;s+=1)this.storage.push(new h(this.context,this.options,this.pipe));for(s=0;s<this.options.edge;s+=1)this.pipe.mirror(s,function(){t.storage.forEach(function(t){return t.draw()})})},o.prototype.resize=function(){this.element.width=this.element.offsetParent?this.element.offsetParent.clientWidth:this.element.clientWidth,this.element.offsetParent&&"BODY"===this.element.offsetParent.nodeName?this.element.height=window.innerHeight:this.element.height=this.element.offsetParent?this.element.offsetParent.clientHeight:this.element.clientHeight},o);function o(t){var i,e;return this.options=null,this.defaults={color:["#FFD1B9","#564138","#2E86AB","#F5F749","#F24236"],edge:10,globalCompositeOperation:"overlay",maxSize:50,minSize:30,quantity:50,selector:null,shapes:["square","circle","wave"],speed:.3},this.element=null,this.context=null,this.animationID=null,this.pipe=null,this.storage=[],this.options=(i=__assign({},this.defaults),e=t,Object.keys(e).forEach(function(t){i[t]=e[t]}),i),this.initializeCanvas(),this.initializeEvents(),this.initializePipe(),this.initializeStorage(),this.animate(),this}return function(t){return new s(t)}}();"undefined"!=typeof module&&module.exports?module.exports=Kaleidoscope:window.Kaleidoscope=Kaleidoscope,exports.default=Kaleidoscope;