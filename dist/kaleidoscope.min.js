"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var i,e=1,n=arguments.length;e<n;e++)for(var s in i=arguments[e])Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s]);return t}).apply(this,arguments)};function extend(i,e){return Object.keys(e).forEach(function(t){i[t]=e[t]}),i}function getRandomInt(t){return Math.floor(Math.random()*Math.floor(t))}function rotate(t,i,e,n,s){return{x:Math.cos(s)*(t-e)-Math.sin(s)*(i-n)+e,y:Math.sin(s)*(t-e)+Math.cos(s)*(i-n)+n}}exports.__esModule=!0;var Pipe=function(){function t(t,i){this.options=null,this.context=null,this.radianAOB=0,this.pointO={x:0,y:0},this.pointA={x:0,y:0},this.pointB={x:0,y:0},this.isSharp=null,this.inclinationOA=0,this.inclinationOB=0,this.interceptOB=0,this.inclinationAB=0,this.context=t,this.options=i,this.radianAOB=2*Math.PI/i.edge;var e=document.querySelector(i.selector);this.pointO.x=e.offsetParent?e.offsetParent.clientWidth/2:e.clientWidth/2,e.offsetParent&&"BODY"===e.offsetParent.nodeName?this.pointO.y=window.innerHeight/2:this.pointO.y=e.offsetParent?e.offsetParent.clientHeight/2:e.clientHeight/2;var n=Math.sqrt(Math.pow(this.pointO.x,2)+Math.pow(this.pointO.y,2))/Math.tan(this.radianAOB/2);this.pointA={x:this.pointO.x-n,y:this.pointO.y-n},this.pointB=rotate(this.pointA.x,this.pointA.y,this.pointO.x,this.pointO.y,this.radianAOB);var s=this.pointO,o=this.pointA,h=this.pointB;this.isSharp=h.x<this.pointO.x,this.inclinationOA=(o.y-s.y)/(o.x-s.x),this.inclinationOB=(h.y-s.y)/(h.x-s.x),this.interceptOB=s.y-this.inclinationOB*s.x,this.inclinationAB=(h.y-o.y)/(h.x-o.x)}return t.prototype.getPointO=function(){return this.pointO},t.prototype.getRandomCoordinates=function(){var t,i=getRandomInt(Math.max(this.pointO.x,this.pointB.x));return{x:i,y:getRandomInt((this.isSharp?(t=Math.max(this.inclinationOB*i+this.interceptOB,this.inclinationAB*i),this.inclinationOA*i):(t=this.inclinationAB*i,Math.min(this.inclinationOA*i,this.inclinationOB*i+this.interceptOB)))-t)+t}},t.prototype.isIn=function(t){var i=!0,e=t.x,n=t.y,s=t.size;if(this.isSharp){var o=Math.max(this.inclinationOB*e+this.interceptOB,this.inclinationAB*e);(this.inclinationOA*e<=n-s||n+s<=o)&&(i=!1)}else{o=this.inclinationAB*e;(Math.min(this.inclinationOA*e,this.inclinationOB*e+this.interceptOB)<=n-s||n+s<=o)&&(i=!1)}return i},t.prototype.mirror=function(t,i){var e=this.context;e.save(),e.translate(this.pointO.x,this.pointO.y),e.rotate(this.radianAOB*t),e.translate(-this.pointO.x,-this.pointO.y),e.beginPath(),e.moveTo(this.pointO.x,this.pointO.y),e.lineTo(this.pointA.x,this.pointA.y),e.lineTo(this.pointB.x,this.pointB.y),e.closePath(),e.clip(),i(),e.restore()},t}(),Particle=function(){function t(t,i,e){this.size=0,this.x=0,this.y=0,this.options=null,this.context=null,this.pipe=null,this.shape=null,this.color=null,this.opacity=0,this.v=0,this.radian=2*Math.PI/(getRandomInt(6)+1),this.directionX=0,this.directionY=0,this.context=t,this.options=i,this.pipe=e,this.shape=i.shapes[getRandomInt(i.shapes.length)],this.size=getRandomInt(i.maxSize-i.minSize)+i.minSize,this.color=i.color[getRandomInt(i.color.length)];var n=e.getRandomCoordinates();return this.x=n.x,this.y=n.y,this.v=(Math.random()+.5)*i.speed,this.initializeEvents(),this}return t.prototype.draw=function(){var t=this.context;switch(this.shape){case"square":t.save(),t.fillStyle=this.color,t.globalAlpha=this.opacity,t.translate(this.x+this.size/2,this.y+this.size/2),t.rotate(this.radian),t.translate(-(this.x+this.size/2),-(this.y+this.size/2)),t.beginPath(),t.rect(this.x,this.y,this.size,this.size),t.closePath(),t.fill(),t.restore();break;case"wave":t.save(),t.strokeStyle=this.color,t.globalAlpha=this.opacity,t.lineWidth=.3*this.size,t.lineJoin="round",t.lineCap="round",t.translate(this.x+.5*this.size,this.y+.2*this.size),t.rotate(this.radian),t.translate(-(this.x+.5*this.size),-(this.y+.2*this.size)),t.beginPath(),t.moveTo(this.x,this.y),t.lineTo(this.x+.2*this.size,this.y+.4*this.size),t.lineTo(this.x+.4*this.size,this.y),t.lineTo(this.x+.6*this.size,this.y+.4*this.size),t.lineTo(this.x+.8*this.size,this.y),t.lineTo(this.x+this.size,this.y+.4*this.size),t.stroke(),t.restore();break;case"circle":t.save(),t.fillStyle=this.color,t.globalAlpha=this.opacity,t.beginPath(),t.arc(this.x,this.y,this.size/2,0,2*Math.PI,!1),t.closePath(),t.fill(),t.restore()}},t.prototype.updateCoordinates=function(){this.opacity<1&&(this.opacity+=.1),this.directionX&&this.directionY?(this.x+=this.v*this.directionX,this.y+=this.v*this.directionY):this.y+=this.v,this.radian+=.002*this.v*Math.PI},t.prototype.isInPipe=function(){return this.pipe.isIn(this)},t.prototype.initializeEvents=function(){var n=this;document.querySelector(this.options.selector).addEventListener("mousemove",function(t){var i=n.pipe.getPointO(),e=Math.sqrt(Math.pow(t.clientX-i.x,2)+Math.pow(t.clientY-i.y,2));0!==e&&(n.directionX=(t.clientX-i.x)/e,n.directionY=(t.clientY-i.y)/e)})},t}(),Kaleidoscope=function(){function t(t){return this.options=null,this.defaults={color:["#FFD1B9","#564138","#2E86AB","#F5F749","#F24236"],edge:7,globalCompositeOperation:"overlay",maxSize:40,minSize:20,quantity:60,selector:null,shapes:["square","circle","wave"],speed:.3},this.element=null,this.context=null,this.animationID=null,this.pipe=null,this.storage=[],this.options=extend(__assign({},this.defaults),t),this.initializeCanvas(),this.initializeEvents(),this.initializePipe(),this.initializeStorage(),this.animate(),this}return t.prototype.initializeCanvas=function(){if(!this.options.selector)return console.warn("kaleidoscope.js: No selector specified!Check https://github.com/kawakamiakari/kaleidoscope"),!1;this.element=document.querySelector(this.options.selector),this.context=this.element.getContext("2d"),this.element.width=this.element.offsetParent?this.element.offsetParent.clientWidth:this.element.clientWidth,this.element.offsetParent&&"BODY"===this.element.offsetParent.nodeName?this.element.height=window.innerHeight:this.element.height=this.element.offsetParent?this.element.offsetParent.clientHeight:this.element.clientHeight,this.element.style.width="100%",this.element.style.height="100%"},t.prototype.initializeEvents=function(){},t.prototype.initializePipe=function(){this.pipe=new Pipe(this.context,this.options)},t.prototype.initializeStorage=function(){this.storage=[];for(var t=0;t<this.options.quantity;t+=1)this.storage.push(new Particle(this.context,this.options,this.pipe))},t.prototype.animate=function(){var t=this;this.draw(),this.animationID=requestAnimationFrame(function(){return t.animate()})},t.prototype.draw=function(){var t=this,i=this.element,e=this.context;e.globalCompositeOperation=this.options.globalCompositeOperation,e.clearRect(0,0,i.width,i.height),this.storage.forEach(function(t){return t.updateCoordinates()}),this.storage=this.storage.filter(function(t){return t.isInPipe()});for(var n=this.storage.length;n<this.options.quantity;n+=1)this.storage.push(new Particle(this.context,this.options,this.pipe));for(n=0;n<this.options.edge;n+=1)this.pipe.mirror(n,function(){t.storage.forEach(function(t){return t.draw()})})},t}();exports.default=Kaleidoscope,"undefined"!=typeof module&&module.exports?module.exports=Kaleidoscope:window.Kaleidoscope=Kaleidoscope;