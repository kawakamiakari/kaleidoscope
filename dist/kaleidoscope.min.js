"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(i){for(var t,s=1,e=arguments.length;s<e;s++)for(var n in t=arguments[s])Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n]);return i}).apply(this,arguments)};exports.__esModule=!0;var Kaleidoscope=function(){function n(i){return Math.floor(Math.random()*Math.floor(i))}var i=(t.prototype.getPointO=function(){return this.pointO},t.prototype.getRandomCoordinates=function(){var i,t=n(Math.max(this.pointO.x,this.pointB.x)-this.pointA.x)+this.pointA.x;return{x:t,y:n((this.isSharp?(i=Math.max(this.inclinationOB*t+this.interceptOB,this.inclinationAB*t+this.interceptAB),this.inclinationOA*t+this.interceptOA):(i=this.inclinationAB*t+this.interceptAB,Math.min(this.inclinationOA*t+this.interceptOA,this.inclinationOB*t+this.interceptOB)))-i)+i}},t.prototype.isIn=function(i){var t=!0,s=i.x,e=i.y,n=2*i.size;if(this.isSharp){var h=Math.max(this.inclinationOB*s+this.interceptOB,this.inclinationAB*s+this.interceptAB);(this.inclinationOA*s+this.interceptOA<e-n||e+n<h)&&(t=!1)}else h=this.inclinationAB*s+this.interceptAB,(Math.min(this.inclinationOA*s+this.interceptOA,this.inclinationOB*s+this.interceptOB)<e-n||e+n<h)&&(t=!1);return t},t.prototype.mirror=function(i,t){var s=this.context;s.save(),s.translate(this.pointO.x,this.pointO.y),s.rotate(this.radianAOB*i),s.translate(-this.pointO.x,-this.pointO.y),s.beginPath(),s.moveTo(this.pointO.x,this.pointO.y),s.lineTo(this.pointA.x,this.pointA.y),s.lineTo(this.pointB.x,this.pointB.y),s.closePath(),s.clip(),t(),s.restore()},t.prototype.destroy=function(){window.removeEventListener("mousemove",this.listenerMousemove)},t.prototype.resize=function(){this.calculateBorder()},t.prototype.initializeEvents=function(){var s=this;this.listenerMousemove=function(i){var t=Math.sqrt(Math.pow(i.clientX-s.pointO.x,2)+Math.pow(i.clientY-s.pointO.y,2));0!==t&&(s.directionX=(i.clientX-s.pointO.x)/t,s.directionY=(i.clientY-s.pointO.y)/t,document.querySelector(s.options.selector).dispatchEvent(new Event("change:direction")))},window.addEventListener("mousemove",this.listenerMousemove)},t.prototype.calculateBorder=function(){var i=document.querySelector(this.options.selector);this.pointO.x=i.offsetParent?i.offsetParent.clientWidth/2:i.clientWidth/2,i.offsetParent&&"BODY"===i.offsetParent.nodeName?this.pointO.y=window.innerHeight/2:this.pointO.y=i.offsetParent?i.offsetParent.clientHeight/2:i.clientHeight/2;var t,s,e,n,h,o=Math.sqrt(Math.pow(this.pointO.x,2)+Math.pow(this.pointO.y,2)),a=o/Math.cos(this.radianAOB/2);this.pointA={x:(1-a/o)*this.pointO.x,y:(1-a/o)*this.pointO.y},this.pointB=(t=this.pointA.x,s=this.pointA.y,e=this.pointO.x,n=this.pointO.y,h=this.radianAOB,{x:Math.cos(h)*(t-e)-Math.sin(h)*(s-n)+e,y:Math.sin(h)*(t-e)+Math.cos(h)*(s-n)+n});var r=this.pointO,l=this.pointA,c=this.pointB;this.isSharp=c.x<this.pointO.x,this.inclinationOA=(l.y-r.y)/(l.x-r.x),this.interceptOA=r.y-this.inclinationOA*r.x,this.inclinationOB=(c.y-r.y)/(c.x-r.x),this.interceptOB=r.y-this.inclinationOB*r.x,this.inclinationAB=(c.y-l.y)/(c.x-l.x),this.interceptAB=l.y-this.inclinationAB*l.x},t);function t(i,t){this.directionX=0,this.directionY=0,this.options=null,this.context=null,this.radianAOB=0,this.pointO={x:0,y:0},this.pointA={x:0,y:0},this.pointB={x:0,y:0},this.isSharp=null,this.inclinationOA=0,this.interceptOA=0,this.inclinationOB=0,this.interceptOB=0,this.inclinationAB=0,this.interceptAB=0,this.context=i,this.options=t,this.radianAOB=2*Math.PI/t.edge,this.calculateBorder(),this.initializeEvents()}var h=(s.prototype.draw=function(){var i=this.context;switch(this.shape){case"square":i.save(),i.fillStyle=this.color,i.globalAlpha=this.opacity,i.translate(this.x+this.size/2,this.y+this.size/2),i.rotate(this.radian),i.translate(-(this.x+this.size/2),-(this.y+this.size/2)),i.beginPath(),i.rect(this.x,this.y,this.size,this.size),i.closePath(),i.fill(),i.restore();break;case"wave":i.save(),i.strokeStyle=this.color,i.globalAlpha=this.opacity,i.lineWidth=.3*this.size,i.lineJoin="round",i.lineCap="round",i.translate(this.x+.5*this.size,this.y+.2*this.size),i.rotate(this.radian),i.translate(-(this.x+.5*this.size),-(this.y+.2*this.size)),i.beginPath(),i.moveTo(this.x,this.y),i.lineTo(this.x+.2*this.size,this.y+.4*this.size),i.lineTo(this.x+.4*this.size,this.y),i.lineTo(this.x+.6*this.size,this.y+.4*this.size),i.lineTo(this.x+.8*this.size,this.y),i.lineTo(this.x+this.size,this.y+.4*this.size),i.stroke(),i.restore();break;case"circle":i.save(),i.fillStyle=this.color,i.globalAlpha=this.opacity,i.beginPath(),i.arc(this.x,this.y,this.size/2,0,2*Math.PI,!1),i.closePath(),i.fill(),i.restore();break;case"heart":i.save(),i.fillStyle=this.color,i.globalAlpha=this.opacity,i.translate(this.x+this.size/2,this.y+this.size/2),i.rotate(this.radian),i.translate(-(this.x+this.size/2),-(this.y+this.size/2)),i.beginPath(),i.moveTo(this.x+75*this.size/130,this.y+40*this.size/140),i.bezierCurveTo(this.x+75*this.size/130,this.y+37*this.size/140,this.x+70*this.size/130,this.y+25*this.size/140,this.x+50*this.size/130,this.y+25*this.size/140),i.bezierCurveTo(this.x+20*this.size/130,this.y+25*this.size/140,this.x+20*this.size/130,this.y+62.5*this.size/140,this.x+20*this.size/130,this.y+62.5*this.size/140),i.bezierCurveTo(this.x+20*this.size/130,this.y+80*this.size/140,this.x+40*this.size/130,this.y+102*this.size/140,this.x+75*this.size/130,this.y+120*this.size/140),i.bezierCurveTo(this.x+110*this.size/130,this.y+102*this.size/140,this.x+this.size,this.y+80*this.size/140,this.x+this.size,this.y+62.5*this.size/140),i.bezierCurveTo(this.x+this.size,this.y+62.5*this.size/140,this.x+this.size,this.y+25*this.size/140,this.x+100*this.size/130,this.y+25*this.size/140),i.bezierCurveTo(this.x+85*this.size/130,this.y+25*this.size/140,this.x+75*this.size/130,this.y+37*this.size/140,this.x+75*this.size/130,this.y+40*this.size/140),i.fill(),i.restore();break;case"star":i.save(),i.fillStyle=this.color,i.globalAlpha=this.opacity,i.translate(this.x+this.size/2,this.y+.9*this.size),i.rotate(this.radian),i.translate(-(this.x+this.size/2),-(this.y+.9*this.size)),i.beginPath(),i.moveTo(this.x,this.y+70*this.size/200),i.lineTo(this.x+this.size,this.y+70*this.size/200),i.lineTo(this.x+35*this.size/200,this.y+180*this.size/200),i.lineTo(this.x+100*this.size/200,this.y),i.lineTo(this.x+165*this.size/200,this.y+180*this.size/200),i.closePath(),i.fill(),i.restore()}},s.prototype.updateCoordinates=function(){this.opacity<1&&(this.opacity+=.1),this.directionX&&this.directionY?(this.x+=this.v*this.directionX,this.y+=this.v*this.directionY):this.y+=this.v,this.radian+=.002*this.v*Math.PI},s.prototype.isInPipe=function(){return this.pipe.isIn(this)},s.prototype.initializeEvents=function(){var i=this;document.querySelector(this.options.selector).addEventListener("change:direction",function(){i.directionX=i.pipe.directionX,i.directionY=i.pipe.directionY})},s);function s(i,t,s){this.size=0,this.x=0,this.y=0,this.options=null,this.context=null,this.pipe=null,this.shape=null,this.color=null,this.opacity=0,this.v=0,this.radian=2*Math.PI/(n(6)+1),this.directionX=0,this.directionY=0,this.context=i,this.options=t,this.pipe=s,this.shape=t.shapes[n(t.shapes.length)],this.size=n(t.maxSize-t.minSize)+t.minSize,this.color=t.color[n(t.color.length)];var e=s.getRandomCoordinates();return this.x=e.x,this.y=e.y,this.v=(Math.random()+.5)*t.speed,this.directionX=s.directionX,this.directionY=s.directionY,this.initializeEvents(),this}var e=(o.prototype.destroy=function(){this.storage=[],this.element.remove(),this.pipe.destroy(),window.removeEventListener("resize",this.listenerResize),cancelAnimationFrame(this.animationID)},o.prototype.pauseAnimation=function(){this.animationID&&(cancelAnimationFrame(this.animationID),this.animationID=null)},o.prototype.resumeAnimation=function(){this.animationID||this.animate()},o.prototype.initializeCanvas=function(){if(!this.options.selector)return console.warn("kaleidoscope.js: No selector specified!Check https://github.com/kawakamiakari/kaleidoscope"),!1;this.element=document.querySelector(this.options.selector),this.context=this.element.getContext("2d"),this.element.style.width="100%",this.element.style.height="100%",this.resize()},o.prototype.initializeEvents=function(){var i=this;this.listenerResize=function(){i.resize(),i.pipe.resize()},window.addEventListener("resize",this.listenerResize)},o.prototype.initializePipe=function(){this.pipe=new i(this.context,this.options)},o.prototype.initializeStorage=function(){this.storage=[];for(var i=0;i<this.options.quantity;i+=1)this.storage.push(new h(this.context,this.options,this.pipe))},o.prototype.animate=function(){var i=this;this.draw(),this.animationID=requestAnimationFrame(function(){return i.animate()})},o.prototype.draw=function(){var i=this,t=this.element,s=this.context;s.globalCompositeOperation=this.options.globalCompositeOperation,s.clearRect(0,0,t.width,t.height),this.storage.forEach(function(i){return i.updateCoordinates()}),this.storage=this.storage.filter(function(i){return i.isInPipe()});for(var e=this.storage.length;e<this.options.quantity;e+=1)this.storage.push(new h(this.context,this.options,this.pipe));for(e=0;e<this.options.edge;e+=1)this.pipe.mirror(e,function(){i.storage.forEach(function(i){return i.draw()})})},o.prototype.resize=function(){this.element.width=this.element.offsetParent?this.element.offsetParent.clientWidth:this.element.clientWidth,this.element.offsetParent&&"BODY"===this.element.offsetParent.nodeName?this.element.height=window.innerHeight:this.element.height=this.element.offsetParent?this.element.offsetParent.clientHeight:this.element.clientHeight},o);function o(i){var t,s;return this.options=null,this.defaults={color:["#FFD1B9","#564138","#2E86AB","#F5F749","#F24236"],edge:10,globalCompositeOperation:"overlay",maxSize:50,minSize:30,quantity:50,selector:null,shapes:["square","circle","wave"],speed:.3},this.element=null,this.context=null,this.animationID=null,this.pipe=null,this.storage=[],this.options=(t=__assign({},this.defaults),s=i,Object.keys(s).forEach(function(i){t[i]=s[i]}),t),this.initializeCanvas(),this.initializeEvents(),this.initializePipe(),this.initializeStorage(),this.animate(),this}return function(i){return new e(i)}}();"undefined"!=typeof module&&module.exports?module.exports=Kaleidoscope:window.Kaleidoscope=Kaleidoscope,exports.default=Kaleidoscope;