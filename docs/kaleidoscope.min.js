"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(i){for(var t,e=1,s=arguments.length;e<s;e++)for(var n in t=arguments[e])Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n]);return i}).apply(this,arguments)};exports.__esModule=!0;var Kaleidoscope=function(){function n(i){return Math.floor(Math.random()*Math.floor(i))}var i=(t.prototype.getPointO=function(){return this.pointO},t.prototype.getRandomCoordinates=function(){var i,t=n(Math.max(this.pointO.x,this.pointB.x)-this.pointA.x)+this.pointA.x;return{x:t,y:n((this.isSharp?(i=Math.max(this.inclinationOB*t+this.interceptOB,this.inclinationAB*t+this.interceptAB),this.inclinationOA*t+this.interceptOA):(i=this.inclinationAB*t+this.interceptAB,Math.min(this.inclinationOA*t+this.interceptOA,this.inclinationOB*t+this.interceptOB)))-i)+i}},t.prototype.isIn=function(i){var t=!0,e=i.x,s=i.y,n=2*i.size;if(this.isSharp){var o=Math.max(this.inclinationOB*e+this.interceptOB,this.inclinationAB*e+this.interceptAB);(this.inclinationOA*e+this.interceptOA<s-n||s+n<o)&&(t=!1)}else o=this.inclinationAB*e+this.interceptAB,(Math.min(this.inclinationOA*e+this.interceptOA,this.inclinationOB*e+this.interceptOB)<s-n||s+n<o)&&(t=!1);return t},t.prototype.mirror=function(i,t){var e=this.context;e.save(),e.translate(this.pointO.x,this.pointO.y),e.rotate(this.radianAOB*i),e.translate(-this.pointO.x,-this.pointO.y),e.beginPath(),e.moveTo(this.pointO.x,this.pointO.y),e.lineTo(this.pointA.x,this.pointA.y),e.lineTo(this.pointB.x,this.pointB.y),e.closePath(),e.clip(),t(),e.restore()},t.prototype.destroy=function(){window.removeEventListener("mousemove",this.listenerMousemove)},t.prototype.resize=function(){this.calculateBorder()},t.prototype.initializeEvents=function(){var e=this;this.listenerMousemove=function(i){var t=Math.sqrt(Math.pow(i.clientX-e.pointO.x,2)+Math.pow(i.clientY-e.pointO.y,2));0!==t&&(e.directionX=(i.clientX-e.pointO.x)/t,e.directionY=(i.clientY-e.pointO.y)/t,document.querySelector(e.options.selector).dispatchEvent(new Event("change:direction")))},window.addEventListener("mousemove",this.listenerMousemove)},t.prototype.calculateBorder=function(){var i=document.querySelector(this.options.selector);this.pointO.x=i.offsetParent?i.offsetParent.clientWidth/2:i.clientWidth/2,i.offsetParent&&"BODY"===i.offsetParent.nodeName?this.pointO.y=window.innerHeight/2:this.pointO.y=i.offsetParent?i.offsetParent.clientHeight/2:i.clientHeight/2;var t,e,s,n,o,h=Math.sqrt(Math.pow(this.pointO.x,2)+Math.pow(this.pointO.y,2)),a=h/Math.cos(this.radianAOB/2);this.pointA={x:(1-a/h)*this.pointO.x,y:(1-a/h)*this.pointO.y},this.pointB=(t=this.pointA.x,e=this.pointA.y,s=this.pointO.x,n=this.pointO.y,o=this.radianAOB,{x:Math.cos(o)*(t-s)-Math.sin(o)*(e-n)+s,y:Math.sin(o)*(t-s)+Math.cos(o)*(e-n)+n});var r=this.pointO,l=this.pointA,c=this.pointB;this.isSharp=c.x<this.pointO.x,this.inclinationOA=(l.y-r.y)/(l.x-r.x),this.interceptOA=r.y-this.inclinationOA*r.x,this.inclinationOB=(c.y-r.y)/(c.x-r.x),this.interceptOB=r.y-this.inclinationOB*r.x,this.inclinationAB=(c.y-l.y)/(c.x-l.x),this.interceptAB=l.y-this.inclinationAB*l.x},t);function t(i,t){this.directionX=0,this.directionY=0,this.options=null,this.context=null,this.radianAOB=0,this.pointO={x:0,y:0},this.pointA={x:0,y:0},this.pointB={x:0,y:0},this.isSharp=null,this.inclinationOA=0,this.interceptOA=0,this.inclinationOB=0,this.interceptOB=0,this.inclinationAB=0,this.interceptAB=0,this.context=i,this.options=t,this.radianAOB=2*Math.PI/t.edge,this.calculateBorder(),this.initializeEvents()}var o=(e.prototype.draw=function(){var i=this.context;switch(this.shape){case"circle":i.save(),i.fillStyle=this.color,i.globalAlpha=this.opacity,i.beginPath(),i.arc(this.x,this.y,this.size/2,0,2*Math.PI,!1),i.closePath(),i.fill(),i.restore();break;case"drop":i.save(),i.fillStyle=this.color,i.globalAlpha=this.opacity,i.translate(this.x+this.size/3,this.y+this.size/2),i.rotate(this.radian),i.translate(-this.size/3,-this.size/2),i.beginPath(),i.moveTo(0,this.size*(2/3)),i.quadraticCurveTo(0,this.size/3,this.size/3,0),i.quadraticCurveTo(this.size*(2/3),this.size*(1/3),this.size*(2/3),this.size*(2/3)),i.arc(this.size*(1/3),this.size*(2/3),this.size*(1/3),0,Math.PI,!1),i.closePath(),i.fill(),i.restore();break;case"heart":i.save(),i.fillStyle=this.color,i.globalAlpha=this.opacity,i.translate(this.x+this.size/2,this.y+this.size/2),i.rotate(this.radian),i.translate(-this.size/2,-this.size/2),i.beginPath(),i.moveTo(this.size*(75/130),this.size*(40/140)),i.bezierCurveTo(this.size*(75/130),this.size*(37/140),this.size*(70/130),this.size*(25/140),this.size*(50/130),this.size*(25/140)),i.bezierCurveTo(this.size*(20/130),this.size*(25/140),this.size*(20/130),this.size*(62.5/140),this.size*(20/130),this.size*(62.5/140)),i.bezierCurveTo(this.size*(20/130),this.size*(80/140),this.size*(40/130),this.size*(102/140),this.size*(75/130),this.size*(120/140)),i.bezierCurveTo(this.size*(110/130),this.size*(102/140),this.size,this.size*(80/140),this.size,this.size*(62.5/140)),i.bezierCurveTo(this.size,this.size*(62.5/140),this.size,this.size*(25/140),this.size*(100/130),this.size*(25/140)),i.bezierCurveTo(this.size*(85/130),this.size*(25/140),this.size*(75/130),this.size*(37/140),this.size*(75/130),this.size*(40/140)),i.fill(),i.restore();break;case"oval":i.save(),i.fillStyle=this.color,i.globalAlpha=this.opacity,i.translate(this.x+this.size/2,this.y+this.size/2),i.rotate(this.radian),i.scale(1,.75),i.translate(-this.size/2,-this.size/2),i.beginPath(),i.arc(0,0,this.size/2,0,2*Math.PI,!1),i.closePath(),i.fill(),i.restore();break;case"square":i.save(),i.fillStyle=this.color,i.globalAlpha=this.opacity,i.translate(this.x+this.size/2,this.y+this.size/2),i.rotate(this.radian),i.translate(-this.size/2,-this.size/2),i.beginPath(),i.rect(0,0,this.size,this.size),i.closePath(),i.fill(),i.restore();break;case"star":i.save(),i.fillStyle=this.color,i.globalAlpha=this.opacity,i.translate(this.x+this.size/2,this.y+.9*this.size),i.rotate(this.radian),i.translate(-this.size/2,-.9*this.size),i.beginPath(),i.moveTo(0,.35*this.size),i.lineTo(this.size,.35*this.size),i.lineTo(.175*this.size,.9*this.size),i.lineTo(.5*this.size,0),i.lineTo(.825*this.size,.9*this.size),i.closePath(),i.fill(),i.restore();break;case"triangle":i.save(),i.fillStyle=this.color,i.globalAlpha=this.opacity,i.translate(this.x+this.size/2,this.y+(1-Math.tan(Math.PI/6)/2)*this.size),i.rotate(this.radian),i.translate(-this.size/2,-(1-Math.tan(Math.PI/6)/2)*this.size),i.beginPath(),i.moveTo(0,this.size),i.lineTo(this.size/2,(1-Math.tan(Math.PI/3)/2)*this.size),i.lineTo(this.size,this.size),i.closePath(),i.fill(),i.restore();break;case"wave":i.save(),i.strokeStyle=this.color,i.globalAlpha=this.opacity,i.lineWidth=.3*this.size,i.lineJoin="round",i.lineCap="round",i.translate(this.x+.5*this.size,this.y+.2*this.size),i.rotate(this.radian),i.translate(-.5*this.size,-.2*this.size),i.beginPath(),i.moveTo(0,0),i.lineTo(.2*this.size,.4*this.size),i.lineTo(.4*this.size,0),i.lineTo(.6*this.size,.4*this.size),i.lineTo(.8*this.size,0),i.lineTo(this.size,.4*this.size),i.stroke(),i.restore()}},e.prototype.updateCoordinates=function(){this.opacity<1&&(this.opacity+=.1),this.directionX&&this.directionY?(this.x+=this.v*this.directionX,this.y+=this.v*this.directionY):this.y+=this.v,this.radian+=.002*this.v*Math.PI},e.prototype.isInPipe=function(){return this.pipe.isIn(this)},e.prototype.initializeEvents=function(){var i=this;document.querySelector(this.options.selector).addEventListener("change:direction",function(){i.directionX=i.pipe.directionX,i.directionY=i.pipe.directionY})},e);function e(i,t,e){this.size=0,this.x=0,this.y=0,this.options=null,this.context=null,this.pipe=null,this.shape=null,this.color=null,this.opacity=0,this.v=0,this.radian=2*Math.PI/(n(6)+1),this.directionX=0,this.directionY=0,this.context=i,this.options=t,this.pipe=e,this.shape=t.shapes[n(t.shapes.length)],this.size=n(t.maxSize-t.minSize)+t.minSize,this.color=t.color[n(t.color.length)];var s=e.getRandomCoordinates();this.x=s.x,this.y=s.y,this.v=(Math.random()+.5)*t.speed,this.directionX=e.directionX,this.directionY=e.directionY,this.initializeEvents()}var s=(h.prototype.destroy=function(){this.storage=[],this.element.remove(),this.pipe.destroy(),window.removeEventListener("resize",this.listenerResize),cancelAnimationFrame(this.animationID)},h.prototype.pauseAnimation=function(){this.animationID&&(cancelAnimationFrame(this.animationID),this.animationID=null)},h.prototype.resumeAnimation=function(){this.animationID||this.animate()},h.prototype.initializeCanvas=function(){if(!this.options.selector)return console.warn("ak-kaleidoscope: No selector specified!Check https://github.com/kawakamiakari/kaleidoscope"),!1;this.element=document.querySelector(this.options.selector),this.context=this.element.getContext("2d"),this.element.style.width="100%",this.element.style.height="100%",this.resize()},h.prototype.initializeEvents=function(){var i=this;this.listenerResize=function(){i.resize(),i.pipe.resize()},window.addEventListener("resize",this.listenerResize)},h.prototype.initializePipe=function(){this.pipe=new i(this.context,this.options)},h.prototype.initializeStorage=function(){this.storage=[];for(var i=0;i<this.options.quantity;i+=1)this.storage.push(new o(this.context,this.options,this.pipe))},h.prototype.animate=function(){var i=this;this.draw(),this.animationID=requestAnimationFrame(function(){return i.animate()})},h.prototype.draw=function(){var i=this,t=this.element,e=this.context;e.globalCompositeOperation=this.options.globalCompositeOperation,e.clearRect(0,0,t.width,t.height),this.storage.forEach(function(i){return i.updateCoordinates()}),this.storage=this.storage.filter(function(i){return i.isInPipe()});for(var s=this.storage.length;s<this.options.quantity;s+=1)this.storage.push(new o(this.context,this.options,this.pipe));for(s=0;s<this.options.edge;s+=1)this.pipe.mirror(s,function(){i.storage.forEach(function(i){return i.draw()})})},h.prototype.resize=function(){this.element.width=this.element.offsetParent?this.element.offsetParent.clientWidth:this.element.clientWidth,this.element.offsetParent&&"BODY"===this.element.offsetParent.nodeName?this.element.height=window.innerHeight:this.element.height=this.element.offsetParent?this.element.offsetParent.clientHeight:this.element.clientHeight},h);function h(i){var t,e;this.options=null,this.defaults={color:["#FFD1B9","#564138","#2E86AB","#F5F749","#F24236"],edge:10,globalCompositeOperation:"overlay",maxSize:50,minSize:30,quantity:50,selector:null,shapes:["square","circle","wave"],speed:.3},this.element=null,this.context=null,this.animationID=null,this.pipe=null,this.storage=[],this.options=(t=__assign({},this.defaults),e=i,Object.keys(e).forEach(function(i){t[i]=e[i]}),t),this.initializeCanvas(),this.initializeEvents(),this.initializePipe(),this.initializeStorage(),this.animate()}return function(i){return new s(i)}}();"undefined"!=typeof module&&module.exports?module.exports=Kaleidoscope:window.Kaleidoscope=Kaleidoscope,exports.default=Kaleidoscope;